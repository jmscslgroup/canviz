
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>strym.strymread &#8212; Strym 0.1.10 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/animate.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/animate.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/venobox.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fontfamily.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/ionicons.min.css" />
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/animate.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/animate.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/venobox.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/fontfamily.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/ionicons.min.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/wow.min.js"></script>
    <script src="../../_static/wow.js"></script>
    <script src="../../_static/hoverIntent.js"></script>
    <script src="../../_static/jquery.easing.min.js"></script>
    <script src="../../_static/jquery.min.js"></script>
    <script src="../../_static/superfish.min.js"></script>
    <script src="../../_static/validate.js"></script>
    <script src="../../_static/venobox.js"></script>
    <script src="../../_static/venobox.min.js"></script>
    <script src="../../_static/main.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/wow.min.js"></script>
    <script src="../../_static/wow.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/favicon.png"></span>
          Strym</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.10</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Strym</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#philosophy-behind-strym">Philosophy behind Strym</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#quick-start-for-can-data-analysis-and-visualization">Quick Start for CAN Data Analysis and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#detailed-examples-of-offline-analysis-and-visualization">Detailed Examples of Offline Analysis and Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#software-requirements">Software Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#hardware-requirements-for-can-logging">Hardware Requirements for CAN Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#installation-instructions">Installation Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#usage-for-real-time-visualization-of-can-messages-using-strym">Usage for Real-Time Visualization of CAN messages using Strym</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#issues">Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#contributing-to-this-project">Contributing to this project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#authors-and-contributors">Authors and Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../readme.html#licensing">Licensing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../youtube.html">Video Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../youtube.html#installation-and-quick-start">1. Installation and Quick Start</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html">Class <code class="code docutils literal notranslate"><span class="pre">strymread</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html#class-strymmap">Class <code class="code docutils literal notranslate"><span class="pre">strymmap</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html#class-phasespace">Class <code class="code docutils literal notranslate"><span class="pre">phasespace</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html#class-strym">Class <code class="code docutils literal notranslate"><span class="pre">strym</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html#class-dashbaord">Class <code class="code docutils literal notranslate"><span class="pre">dashbaord</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html#class-meta">Class <code class="code docutils literal notranslate"><span class="pre">meta</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_docs.html#functions">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#july-23">0.1.11 - 2020-July-23</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#july-01">0.1.10 - 2020-July-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#may-20">0.1.9 - 2020-May-20</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#may-16">0.1.8 - 2020-May-16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#may-06">0.1.7 - 2020-May-06</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-22">0.1.6 - 2020-Apr-22</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#apr-01">0.1.5 - 2020-Apr-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#id1">0.1.4 - 2020-Apr-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#id2">0.1.3 - 2020-Apr-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#id3">0.1.2 - 2020-Apr-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#mar-30">0.1.1 - 2020-Mar-30</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#id4">0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html#unreleased">unreleased</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Index <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for strym.strymread</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># coding: utf-8</span>

<span class="c1"># Author : Rahul Bhadani, Gustavo Lee</span>
<span class="c1"># Initial Date: Feb 17, 2020</span>
<span class="c1"># About: strymread class to read CAN data from CSV file recorded from `strym` class. Read associated README for full description</span>
<span class="c1"># License: MIT License</span>

<span class="c1">#   Permission is hereby granted, free of charge, to any person obtaining</span>
<span class="c1">#   a copy of this software and associated documentation files</span>
<span class="c1">#   (the &quot;Software&quot;), to deal in the Software without restriction, including</span>
<span class="c1">#   without limitation the rights to use, copy, modify, merge, publish,</span>
<span class="c1">#   distribute, sublicense, and/or sell copies of the Software, and to</span>
<span class="c1">#   permit persons to whom the Software is furnished to do so, subject</span>
<span class="c1">#   to the following conditions:</span>

<span class="c1">#   The above copyright notice and this permission notice shall be</span>
<span class="c1">#   included in all copies or substantial portions of the Software.</span>

<span class="c1">#   THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF</span>
<span class="c1">#   ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED</span>
<span class="c1">#   TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A</span>
<span class="c1">#   PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT</span>
<span class="c1">#   SHALL THE AUTHORS, COPYRIGHT HOLDERS OR ARIZONA BOARD OF REGENTS</span>
<span class="c1">#   BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN</span>
<span class="c1">#   AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1">#   OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE</span>
<span class="c1">#   OR OTHER DEALINGS IN THE SOFTWARE.</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Rahul Bhadani&#39;</span>
<span class="n">__email__</span>  <span class="o">=</span> <span class="s1">&#39;rahulbhadani@email.arizona.edu&#39;</span>

<span class="c1"># For System and OS level task</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">getopt</span>

<span class="c1">## General Data processing and visualization Import</span>

<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">bitstring</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">serial</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># Note that this is not commai Panda, but Database Pandas</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">LinearLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">scipy.special</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">expanduser</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sea</span>

<span class="kn">import</span> <span class="nn">libusb1</span>
<span class="kn">import</span> <span class="nn">usb1</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="c1"># cantools import</span>
<span class="kn">import</span> <span class="nn">cantools</span>
<span class="kn">import</span> <span class="nn">strym.DBC_Read_Tools</span> <span class="k">as</span> <span class="nn">dbc</span>

<div class="viewcode-block" id="strymread"><a class="viewcode-back" href="../../api_docs.html#strym.strymread">[docs]</a><span class="k">class</span> <span class="nc">strymread</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    `strymread` reads the logged CAN data from the given CSV file.</span>
<span class="sd">    This class provides several utilities functions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">    csvfile: `str`, `pandas.DataFrame`,  default = None</span>
<span class="sd">        The CSV file to be read. If `pandas.DataFrame` is supplied, then csvfile is set to None</span>
<span class="sd">        PandasDataFrame, if provided, must have  columns [&quot;Time&quot;, &quot;Message&quot;, &quot;MessageID&quot;, &quot;Bus&quot;]</span>
<span class="sd">    </span>
<span class="sd">    dbcfile: `str`,  default = &quot;&quot;</span>
<span class="sd">        The DBC file which will provide codec for decoding CAN messages</span>

<span class="sd">    kwargs: variable list of argument in the dictionary format</span>


<span class="sd">    Attributes</span>
<span class="sd">    ---------------</span>
<span class="sd">    dbcfile: `str`, default = &quot;&quot;</span>
<span class="sd">        The filepath of DBC file </span>

<span class="sd">    csvfile:`str`, default=None</span>
<span class="sd">        The filepath of CSV Data file.</span>

<span class="sd">    dataframe: `pandas.Dataframe`</span>
<span class="sd">        Pandas dataframe that stores content of csvfile as dataframe</span>

<span class="sd">    dataframe_raw: `pandas.Dataframe`</span>
<span class="sd">        Pandas original dataframe with all bus IDs. When `bus=` is passed to the constructor to filter out dataframe based on bus id, then original dataframe is save</span>
<span class="sd">        in dataframe_raw</span>

<span class="sd">    candb: `cantools.db`</span>
<span class="sd">        CAN database fetched from DBC file</span>

<span class="sd">    burst: `bool`</span>
<span class="sd">        A boolean flag that checks if CAN data came in burst. If `True`, then CAN Data was captured in burst, else</span>
<span class="sd">        `False`. If CAN Data came in burst (as in say 64 messages at a time or so)</span>
<span class="sd">        then any further analysis might not be reliable. Always check that. </span>

<span class="sd">    success: `bool`</span>
<span class="sd">        A boolean flag, if `True`, tells that reading of CSV file was successful.</span>

<span class="sd">    bus: `list` | default = None</span>
<span class="sd">        A list of integer correspond to Bus ID.</span>


<span class="sd">    Returns</span>
<span class="sd">    ---------------</span>
<span class="sd">    `strymread`</span>
<span class="sd">        Returns an object of type `strymread` upon successful reading or else return None</span>

<span class="sd">    Example</span>
<span class="sd">    ----------------</span>
<span class="sd">    &gt;&gt;&gt; import strym</span>
<span class="sd">    &gt;&gt;&gt; from strym import strymread</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; dbcfile = &#39;newToyotacode.dbc&#39;</span>
<span class="sd">    &gt;&gt;&gt; csvdata = &#39;2020-03-20.csv&#39;</span>
<span class="sd">    &gt;&gt;&gt; r0 = strymread(csvfile=csvdata, dbcfile=dbcfile)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csvfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dbcfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Times New Roman&quot;</span>
        <span class="c1"># CSV File</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bus&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bus</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">csvfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;csvfile is None. Unable to proceed with further analysis. See https://jmscslgroup.github.io/strym/api_docs.html#module-strym for further details.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">csvfile</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span> <span class="o">=</span> <span class="n">csvfile</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsupported type for csvfile. Please see https://jmscslgroup.github.io/strym/api_docs.html#module-strym for further details.&quot;</span><span class="p">)</span>
            
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># All CAN messages will be saved as pandas dataframe</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">pd</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">ParserError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ill-formated CSV File. A properly formatted CAN-data CSV file must have at least following columns:  [&#39;Time&#39;, &#39;Bus&#39;, &#39;MessageID&#39;, &#39;Message&#39;]&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data was written the csvfile. Unable to perform further operation&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ill-formated CSV File. A properly formatted CAN-data  CSV file must have at least following columns:  [&#39;Time&#39;, &#39;Bus&#39;, &#39;MessageID&#39;, &#39;Message&#39;]&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data was written the csvfile. Unable to perform further operation&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="n">pd</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">EmptyDataError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CSVfile is empty.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data was present in the csvfile or pandas dataframe supplied is empty. Unable to perform further operation&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;MessageID&#39;</span><span class="p">,</span> <span class="s1">&#39;Message&#39;</span><span class="p">,</span> <span class="s1">&#39;Bus&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ill-formated CSV File or pandas dataframe. A properly formatted CAN-data CSV file/dataframe must have at least following columns:  [&#39;Time&#39;, &#39;Bus&#39;, &#39;MessageID&#39;, &#39;Message&#39;]&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unable to perform further operation&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Timestamps are not monotonically increasing. Further analysis is not recommended.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># if control comes to the point, then the reading of CSV file was successful</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span>  <span class="n">timeindex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_raw</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Bus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;One of the bus id not available.&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available BUS IDs are </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Bus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Bus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">burst</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Check if data came in burst</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">T_head</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">T_head</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">burst</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># DBC file that has CAN message codec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span> <span class="o">=</span> <span class="n">dbcfile</span>
        <span class="c1"># save the CAN database for later use</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candb</span> <span class="o">=</span> <span class="n">cantools</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">candb</span> <span class="o">=</span> <span class="kc">None</span>
            
        <span class="c1"># initialize the dbc lookups for any particular usage</span>
        <span class="c1"># this creates the dict later used to figure out which signals/msgs to </span>
        <span class="c1"># use when decoding these data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dbc_init_dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_set_dbc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `_set_dbc` sets the DBC file</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;DBC file unspecified. Enter the filepath of the DBC file: &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The new DBC file entered is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DBC file entered is not a string&#39;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">candb</span> <span class="o">=</span> <span class="n">cantools</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">)</span>

<div class="viewcode-block" id="strymread.get_ts"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.get_ts">[docs]</a>    <span class="k">def</span> <span class="nf">get_ts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `get_ts`  returns Timeseries data by given `msg_name` and `signal_name`</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        msg: `string`| `int` A valid message that can be found in the given DBC file. Can be specified as message name or message ID</span>
<span class="sd">        </span>
<span class="sd">        signal: `string` | `int` A valid signal in string format corresponding to `msg_name` that can be found in the given DBC file.  Can be specified as signal name or signal ID</span>

<span class="sd">        verbose: `bool`, default = False</span>
<span class="sd">            If True, print some information</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_dbc</span><span class="p">()</span>

        <span class="k">assert</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="nb">str</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;Only Integer message ID or string name is supported for msg_name&quot;</span><span class="p">)</span>
        
        <span class="k">assert</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="nb">str</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;Only Integer signal ID or string name is supported for signal_name&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getMessageName</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Message Name: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalName</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Signal Name: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
            
        <span class="k">return</span> <span class="n">dbc</span><span class="o">.</span><span class="n">convertData</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.messageIDs"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.messageIDs">[docs]</a>    <span class="k">def</span> <span class="nf">messageIDs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>

<span class="sd">        Retreives list of all messages IDs available in the given CSV-formatted CAN data file.</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `list`</span>
<span class="sd">            A python list of all available message IDs  in the given CSV-formatted CAN data file.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">msgIDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">msgIDs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">msgIDs</span></div>

<div class="viewcode-block" id="strymread.count"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.count">[docs]</a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A utility function to plot counts for each Message ID as bar graph</span>

<span class="sd">        Example</span>
<span class="sd">        ---------</span>
<span class="sd">        &gt;&gt;&gt; import strym</span>
<span class="sd">        &gt;&gt;&gt; from strym import strymread</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; dbcfile = &#39;newToyotacode.dbc&#39;</span>
<span class="sd">        &gt;&gt;&gt; csvdata = &#39;2020-03-20.csv&#39;</span>
<span class="sd">        &gt;&gt;&gt; r0 = strymread(csvfile=csvlist[0], dbcfile=dbcfile)</span>
<span class="sd">        &gt;&gt;&gt; ro.count()    </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span><span class="mi">200</span><span class="p">]</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">200</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">400</span><span class="p">)]</span>
        <span class="n">r3</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">400</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">600</span><span class="p">)]</span>
        <span class="n">r4</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">600</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">800</span><span class="p">)]</span>
        <span class="n">r5</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">800</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)]</span>
        <span class="n">r6</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">1000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1200</span><span class="p">)]</span>
        <span class="n">r7</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">1200</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1400</span><span class="p">)]</span>
        <span class="n">r8</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">1400</span><span class="p">)</span> <span class="p">]</span>

        <span class="n">r_df</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">,</span> <span class="n">r5</span><span class="p">,</span> <span class="n">r6</span><span class="p">,</span> <span class="n">r7</span><span class="p">,</span> <span class="n">r8</span><span class="p">]</span>
        <span class="n">_setplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_fig</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="n">r_df</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cnt</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">cnt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Message ID counts: &quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="strymread.start_time"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.start_time">[docs]</a>    <span class="k">def</span> <span class="nf">start_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `start_time` retrieves the the human-readable  time when logging of the data started</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `str`</span>
<span class="sd">            Human-readable string-formatted time.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="strymread.end_time"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.end_time">[docs]</a>    <span class="k">def</span> <span class="nf">end_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `end_time` retrieves the the human-readable  time  when logging of the data was stopped.</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `str`</span>
<span class="sd">            Human-readable string-formatted time.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="strymread.triptime"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.triptime">[docs]</a>    <span class="k">def</span> <span class="nf">triptime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `triptime` retrieves total duration of the recording for given CSV-formatted log file in seconds.</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `double`</span>
<span class="sd">            Duration in seconds.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">duration</span></div>

<div class="viewcode-block" id="strymread.triplength"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.triplength">[docs]</a>    <span class="k">def</span> <span class="nf">triplength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `triplength` returns  total distance travelled while logging CAN data.</span>

<span class="sd">        Alternative, one can provide a second argument `time` to query how much distance was traveled in, say 50 seconds from start.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        time: `double`</span>
<span class="sd">            Provide a valid elapsed time in seconds to query how much distance was traveled `time` seconds since the logging of data was started.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># first convert speed in km/h to m/s</span>
        <span class="n">speed</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">()</span>
        <span class="n">speed_in_ms</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">speed_in_ms</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">speed</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
        <span class="n">speed_in_ms</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">speed</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1000.0</span><span class="o">/</span><span class="mf">3600.0</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">speed_in_ms</span><span class="p">)</span>

        <span class="n">required_distance</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">required_distance</span> <span class="o">=</span>  <span class="n">dist</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">triptime</span><span class="p">():</span>
                <span class="n">desired_time</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">time</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">dist</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">desired_time</span><span class="p">]</span>
                <span class="n">required_distance</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">required_distance</span></div>

<div class="viewcode-block" id="strymread.driving_characteristics"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.driving_characteristics">[docs]</a>    <span class="k">def</span> <span class="nf">driving_characteristics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        `driving_characteristics` provides driving characteristics for the given driving data  in the form of python dictionary.</span>

<span class="sd">        Currently, the dictionary contains following metadata from the driving data</span>
<span class="sd">        </span>
<span class="sd">        - File name of CSV-formatedd CAN data file</span>
<span class="sd">        - Associated DBC file used</span>
<span class="sd">        - Start time of the trip in human-readable date format</span>
<span class="sd">        - End time of the trip in human-readable date format</span>
<span class="sd">        - Total duration of the trip</span>
<span class="sd">        - Total distance traveled in meters</span>
<span class="sd">        - Total distance traveled in kilometers</span>
<span class="sd">        - Total distance traveled in miles</span>


<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `dictionary`</span>
<span class="sd">            A python dictionary containing driving metadata</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">()</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_time</span><span class="p">()</span>
        <span class="n">trip_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">triptime</span><span class="p">()</span>
        <span class="n">trip_length_in_meters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">triplength</span><span class="p">()</span>

        <span class="n">trip_length_in_km</span> <span class="o">=</span> <span class="n">trip_length_in_meters</span><span class="o">/</span><span class="mf">1000.0</span>
        <span class="n">trip_length_in_miles</span> <span class="o">=</span> <span class="n">trip_length_in_meters</span><span class="o">/</span><span class="mf">1609.34</span>

        <span class="n">drive</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">,</span> <span class="s1">&#39;dbcfile&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">,</span> <span class="s1">&#39;distance_meters&#39;</span><span class="p">:</span><span class="n">trip_length_in_meters</span><span class="p">,</span> <span class="s1">&#39;distance_km&#39;</span><span class="p">:</span> <span class="n">trip_length_in_km</span><span class="p">,</span>  <span class="s1">&#39;distance_miles&#39;</span><span class="p">:</span> <span class="n">trip_length_in_miles</span><span class="p">,</span> <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">start_time</span><span class="p">,</span> <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">end_time</span><span class="p">,</span> <span class="s1">&#39;trip_time&#39;</span><span class="p">:</span> <span class="n">trip_time</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">drive</span></div>

<div class="viewcode-block" id="strymread.speed"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.speed">[docs]</a>    <span class="k">def</span> <span class="nf">speed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries speed data from the CSV file</span>

<span class="sd">        Example</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; import strym</span>
<span class="sd">        &gt;&gt;&gt; from strym import strymread</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; dbcfile = &#39;newToyotacode.dbc&#39;</span>
<span class="sd">        &gt;&gt;&gt; csvdata = &#39;2020-03-20.csv&#39;</span>
<span class="sd">        &gt;&gt;&gt; r0 = strymread(csvfile=csvlist[0], dbcfile=dbcfile)</span>
<span class="sd">        &gt;&gt;&gt; speed = r0.ts_speed()</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># OLD</span>
        <span class="c1"># return self.get_ts(&#39;SPEED&#39;, 1)</span>
        <span class="c1"># NEW</span>
        <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">topic2msgs</span><span class="p">(</span><span class="s1">&#39;speed&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="strymread.accely"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.accely">[docs]</a>    <span class="k">def</span> <span class="nf">accely</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for acceleration in y-direction from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="s1">&#39;KINEMATICS&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEL_Y&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;KINEMATICS&#39;</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.accelx"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.accelx">[docs]</a>    <span class="k">def</span> <span class="nf">accelx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for acceleration in x-direction  (i.e. longitudinal acceleration) from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;ACCELEROMETER&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEL_X&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ts</span></div>

<div class="viewcode-block" id="strymread.accelz"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.accelz">[docs]</a>    <span class="k">def</span> <span class="nf">accelz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for acceleration in z-direction  from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;ACCELEROMETER&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEL_Z&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ts</span></div>

<div class="viewcode-block" id="strymread.steer_torque"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.steer_torque">[docs]</a>    <span class="k">def</span> <span class="nf">steer_torque</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for steering torque from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="s1">&#39;KINEMATICS&#39;</span><span class="p">,</span> <span class="s1">&#39;STEERING_TORQUE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;KINEMATICS&#39;</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="strymread.yaw_rate"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.yaw_rate">[docs]</a>    <span class="k">def</span> <span class="nf">yaw_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for yaw rate from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="s1">&#39;KINEMATICS&#39;</span><span class="p">,</span> <span class="s1">&#39;YAW_RATE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;KINEMATICS&#39;</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="strymread.steer_rate"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.steer_rate">[docs]</a>    <span class="k">def</span> <span class="nf">steer_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for steering  rate from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="s1">&#39;STEER_ANGLE_SENSOR&#39;</span><span class="p">,</span> <span class="s1">&#39;STEER_RATE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;STEER_ANGLE_SENSOR&#39;</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.steer_angle"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.steer_angle">[docs]</a>    <span class="k">def</span> <span class="nf">steer_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for steering  angle from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
<span class="c1">#         signal_id = dbc.getSignalID(&#39;STEER_ANGLE_SENSOR&#39;, &#39;STEER_ANGLE&#39;, self.candb)</span>
<span class="c1">#         return self.get_ts(&#39;STEER_ANGLE_SENSOR&#39;, signal_id)</span>
        <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbc2msgs</span><span class="p">(</span><span class="s1">&#39;steer_angle&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">])</span></div>
    <span class="c1"># NEXT</span>

<div class="viewcode-block" id="strymread.steer_fraction"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.steer_fraction">[docs]</a>    <span class="k">def</span> <span class="nf">steer_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data for steering  fraction from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="s1">&#39;STEER_ANGLE_SENSOR&#39;</span><span class="p">,</span> <span class="s1">&#39;STEER_FRACTION&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;STEER_ANGLE_SENSOR&#39;</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.wheel_speed_fl"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.wheel_speed_fl">[docs]</a>    <span class="k">def</span> <span class="nf">wheel_speed_fl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseeries data for wheel speed of front left tire from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEEDS&#39;</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEED_FL&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.wheel_speed_fr"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.wheel_speed_fr">[docs]</a>    <span class="k">def</span> <span class="nf">wheel_speed_fr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseeries data for wheel speed of front right tire from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEEDS&#39;</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEED_FR&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.wheel_speed_rr"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.wheel_speed_rr">[docs]</a>    <span class="k">def</span> <span class="nf">wheel_speed_rr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseeries data for wheel speed of rear right tire from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEEDS&#39;</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEED_RR&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>
   
<div class="viewcode-block" id="strymread.wheel_speed_rl"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.wheel_speed_rl">[docs]</a>    <span class="k">def</span> <span class="nf">wheel_speed_rl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseeries data for wheel speed of rear left tire from the CSV file</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEEDS&#39;</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;WHEEL_SPEED_RL&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.rel_accel"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.rel_accel">[docs]</a>    <span class="k">def</span> <span class="nf">rel_accel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track_id</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        utility function to return timeseries relative acceleration of detected object from radar traces of particular track id</span>

<span class="sd">        Parameters</span>
<span class="sd">        --------------</span>
<span class="sd">        track_id: int | `numpy array` | list</span>

<span class="sd">        Returns </span>
<span class="sd">        -----------</span>
<span class="sd">        `pandas.DataFrame` | `list&lt;pandas.DataFrame&gt;`</span>
<span class="sd">            Timeseries relative acceleration data from the CSV file</span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">df_obj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">track_id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">track_id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                <span class="k">raise</span>
            <span class="n">df_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_B_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">track_id</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">track_id</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                    <span class="k">raise</span>
                <span class="n">df_obj1</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_B_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">df_obj1</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">df_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_obj1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_obj</span></div>

<div class="viewcode-block" id="strymread.long_dist"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.long_dist">[docs]</a>    <span class="k">def</span> <span class="nf">long_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track_id</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        utility function to return timeseries longitudinal distance from radar traces of particular track id</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        track_id: `int` | `numpy array` | `list`</span>

<span class="sd">        Returns </span>
<span class="sd">        -----------</span>
<span class="sd">        `pandas.DataFrame` | `list&lt;pandas.DataFrame&gt;`</span>
<span class="sd">            Timeseries longitduinal distance data from the CSV file</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">df_obj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">track_id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">track_id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                <span class="k">raise</span>
            <span class="n">df_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_A_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">track_id</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">track_id</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                    <span class="k">raise</span>
                <span class="n">df_obj1</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_A_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">df_obj1</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">df_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_obj1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_obj</span></div>

<div class="viewcode-block" id="strymread.lat_dist"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.lat_dist">[docs]</a>    <span class="k">def</span> <span class="nf">lat_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track_id</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        utility function to return timeseries lateral distance from radar traces of particular track id</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        track_id: int | `numpy array` | list</span>
<span class="sd">         </span>
<span class="sd">        Returns </span>
<span class="sd">        -----------</span>
<span class="sd">        `pandas.DataFrame` | `list&lt;pandas.DataFrame&gt;`</span>
<span class="sd">            Timeseries lateral distance data from the CSV file</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">df_obj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">track_id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">track_id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                <span class="k">raise</span>
            <span class="n">df_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_A_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">track_id</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">track_id</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                    <span class="k">raise</span>
                <span class="n">df_obj1</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_A_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">df_obj1</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">df_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_obj1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_obj</span></div>

<div class="viewcode-block" id="strymread.rel_velocity"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.rel_velocity">[docs]</a>    <span class="k">def</span> <span class="nf">rel_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track_id</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        utility function to return timeseries lateral distance from radar traces of particular track id</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        track_id: int | `numpy array` | list</span>
<span class="sd">         </span>
<span class="sd">        Returns </span>
<span class="sd">        -----------</span>
<span class="sd">        `pandas.DataFrame` | `list&lt;pandas.DataFrame&gt;`</span>
<span class="sd">            Timeseries lateral distance data from the CSV file</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">df_obj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">track_id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">track_id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                <span class="k">raise</span>
            <span class="n">df_obj</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_A_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">track_id</span><span class="p">),</span> <span class="n">signal</span><span class="o">=</span><span class="s2">&quot;REL_SPEED&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">track_id</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">id</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid track id:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">track_id</span><span class="p">))</span>
                    <span class="k">raise</span>
                <span class="n">df_obj1</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;TRACK_A_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="n">signal</span><span class="o">=</span><span class="s2">&quot;REL_SPEED&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">df_obj1</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">df_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_obj1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_obj</span></div>

<div class="viewcode-block" id="strymread.acc_state"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.acc_state">[docs]</a>    <span class="k">def</span> <span class="nf">acc_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the cruise control state of the vehicle</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Timeseries data with different levels corresponding to different cruise control state</span>

<span class="sd">            &quot;disabled&quot;: 2, &quot;hold&quot;: 11, &quot;hold_waiting_user_cmd&quot;: 10, &quot;enabled&quot;: 6,  &quot;faulted&quot;: 5;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;PCM_CRUISE_SM&#39;</span>
        <span class="n">signal</span> <span class="o">=</span> <span class="s1">&#39;CRUISE_CONTROL_STATE&#39;</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">getSignalID</span><span class="p">(</span><span class="n">message</span><span class="p">,</span><span class="n">signal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Message</span> <span class="o">==</span> <span class="s1">&#39;disabled&#39;</span><span class="p">),</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Message</span> <span class="o">==</span> <span class="s1">&#39;hold&#39;</span><span class="p">),</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Message</span> <span class="o">==</span> <span class="s1">&#39;hold_waiting_user_cmd&#39;</span><span class="p">),</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Message</span> <span class="o">==</span> <span class="s1">&#39;enabled&#39;</span><span class="p">),</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Message</span> <span class="o">==</span> <span class="s1">&#39;faulted&#39;</span><span class="p">),</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

        <span class="c1"># plt.rcParams[&quot;figure.figsize&quot;] = (16,5)</span>
        <span class="c1"># sea.scatterplot(x=&#39;Time&#39;, y=&#39;Message&#39;, data=df)</span>
        <span class="c1"># plt.yticks([0, 2, 5, 6, 10, 11], [&#39;0&#39;, &#39;disabled (2)&#39;, &#39;faulted (5)&#39;, &#39;enabled (6)&#39;, &#39;hold_waiting_user_cmd (10)&#39;, &#39;hold (11)&#39;])</span>
        <span class="c1"># plt.title(message + &quot;: &quot; + signal,  fontsize=18)</span>
        <span class="c1"># plt.xlabel(&#39;Time&#39;, fontsize=16)</span>
        <span class="c1"># plt.ylabel(&#39;Cruise Control State&#39;, fontsize=16)</span>
        <span class="c1"># plt.show()</span>

        <span class="k">return</span> <span class="n">df</span></div>
        
<div class="viewcode-block" id="strymread.plt_speed"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.plt_speed">[docs]</a>    <span class="k">def</span> <span class="nf">plt_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Utility function to plot speed data</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dbc</span><span class="o">.</span><span class="n">plotDBC</span><span class="p">(</span><span class="s1">&#39;SPEED&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span><span class="p">)</span></div>

<div class="viewcode-block" id="strymread.frequency"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.frequency">[docs]</a>    <span class="k">def</span> <span class="nf">frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Retrieves the frequency of each message in a pandas.Dataframe()</span>


<span class="sd">        +-----------+----------+------------+---------+---------+---------+---------+</span>
<span class="sd">        | MessageID | MeanRate | MedianRate | RateStd | MaxRate | MinRate | RateIQR |</span>
<span class="sd">        +-----------+----------+------------+---------+---------+---------+---------+</span>
<span class="sd">        |           |          |            |         |         |         |         |</span>
<span class="sd">        +-----------+----------+------------+---------+---------+---------+---------+</span>
<span class="sd">        |           |          |            |         |         |         |         |</span>
<span class="sd">        +-----------+----------+------------+---------+---------+---------+---------+</span>
<span class="sd">        |           |          |            |         |         |         |         |</span>
<span class="sd">        +-----------+----------+------------+---------+---------+---------+---------+</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            Returns the a data frame containing mean rate, std rate, max rate, min rate, rate iqr</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">messageIDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageIDs</span><span class="p">()</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">medians</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">maxs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">stds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">iqrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="n">messageIDs</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ID</span><span class="p">]</span>
            <span class="n">tdiff</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
            <span class="n">tdiff</span> <span class="o">=</span> <span class="n">tdiff</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">medians</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">maxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">mins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="n">stds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

            <span class="n">first_quartile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
            <span class="n">third_quartile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">tdiff</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
            <span class="n">iqrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">third_quartile</span><span class="o">-</span> <span class="n">first_quartile</span><span class="p">)</span> <span class="c1">#interquartile range</span>

        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;MessageID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">messageIDs</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;MeanRate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">means</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;MedianRate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">medians</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;RateStd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stds</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;MaxRate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxs</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;MinRate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mins</span>
        <span class="n">f</span><span class="p">[</span><span class="s1">&#39;RateIQR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iqrs</span>

        <span class="k">return</span> <span class="n">f</span></div>

    <span class="c1"># Based on MATLAB Code provided by Gustavo Lee</span>
<div class="viewcode-block" id="strymread.trajectory"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.trajectory">[docs]</a>    <span class="k">def</span> <span class="nf">trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_init</span>  <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">y_init</span><span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">data_rate</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A simple trajectory tracing function based on CAN data</span>

<span class="sd">        Parameters</span>
<span class="sd">        --------------</span>
<span class="sd">        x_init: `double`</span>
<span class="sd">            Initial X-coordinate of the vehicle</span>
<span class="sd">        </span>
<span class="sd">        y_init: `double`</span>
<span class="sd">            Initial Y-coordinate of the vehicle</span>

<span class="sd">        data_rate: `double`</span>
<span class="sd">            Rate at which message are sampled.</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>

<span class="sd">        `pandas.DataFrame`</span>
<span class="sd">            A pandas Dataframe with three columns: Time, X, Y, Vx, Vy</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">ts_yaw_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaw_rate</span><span class="p">()</span>
        <span class="n">ts_speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">()</span>

        <span class="c1"># integrate yaw rate to get the heading</span>
        <span class="n">ts_yaw</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">ts_yaw_rate</span><span class="p">)</span>

        <span class="n">ts_resampled_yaw</span><span class="p">,</span> <span class="n">ts_resampled_speed</span> <span class="o">=</span> <span class="n">ts_sync</span><span class="p">(</span><span class="n">ts_yaw</span><span class="p">,</span> <span class="n">ts_speed</span><span class="p">)</span>

        <span class="n">yaw</span> <span class="o">=</span> <span class="n">ts_resampled_yaw</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">ts_resampled_speed</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        X_Pos = Initial_Position(1);</span>
<span class="sd">        Y_Pos = Initial_Position(2);</span>
<span class="sd">        kph_to_mps = 1000/3600;</span>
<span class="sd">        for i = 1:length(Complete_Speed)        </span>
<span class="sd">            Vx(i) = cosd(Complete_Heading(i))*kph_to_mps*Complete_Speed(i);</span>
<span class="sd">            Vy(i) = sind(Complete_Heading(i))*kph_to_mps*Complete_Speed(i);</span>
<span class="sd">            X_Pos(i) = X_Pos(end) + Vx(i)*dt;</span>
<span class="sd">            Y_Pos(i) = Y_Pos(end) + Vy(i)*dt;</span>
<span class="sd">        end</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">data_rate</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Vx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Vy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_init</span><span class="p">)</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_init</span><span class="p">)</span>
        <span class="n">Vx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">Vy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">kph_to_mps</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="o">/</span><span class="mf">3600.0</span> <span class="c1"># kph to meter per second</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ts_resampled_speed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">vx</span> <span class="o">=</span> <span class="n">speed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">yaw</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">*</span><span class="n">kph_to_mps</span>
            <span class="n">vy</span> <span class="o">=</span> <span class="n">speed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">yaw</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">*</span><span class="n">kph_to_mps</span>
            <span class="n">x</span> <span class="o">=</span>  <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">vx</span><span class="o">*</span><span class="n">dt</span>
            <span class="n">y</span> <span class="o">=</span>  <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">vy</span><span class="o">*</span><span class="n">dt</span>
            <span class="n">Vx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vx</span><span class="p">)</span>
            <span class="n">Vy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vy</span><span class="p">)</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">traj</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        
        <span class="n">Time</span> <span class="o">=</span> <span class="n">ts_resampled_yaw</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>

        <span class="n">ExtendedTime</span> <span class="o">=</span> <span class="p">[</span><span class="n">Time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span><span class="p">]</span>
        <span class="n">ExtendedTime</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">Time</span>
        <span class="n">ExtendedTime</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ExtendedTime</span><span class="p">)</span>

        <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ExtendedTime</span>
        <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
        <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span>
        <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;Vx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vx</span>
        <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;Vy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vy</span>

        <span class="k">return</span> <span class="n">traj</span></div>

<div class="viewcode-block" id="strymread.msg_subset"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.msg_subset">[docs]</a>    <span class="k">def</span> <span class="nf">msg_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the subset of message dataframe  based on a condition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>

<span class="sd">        kwargs: variable list of argument in the dictionary format</span>

<span class="sd">            conditions: `str` | `list&lt;str&gt;`</span>
<span class="sd">            </span>
<span class="sd">                Human readable condition for subsetting of message dataframe.</span>
<span class="sd">                Following conditions are available:</span>
<span class="sd">                </span>
<span class="sd">                - *lead vehicle present*: Extracts only those messages for which there was lead vehicle present.</span>
<span class="sd">                - *cruise control on*: Extracts only those messages for which cruise control is on.</span>
<span class="sd">                - *operand op x*: Extracts those messages for which operator `op` is operated on operand to fulfil `x`. </span>
<span class="sd">                </span>
<span class="sd">                Available operators `op` are `[&gt;,&lt;,==, !=, &gt;=,&lt;=]`</span>

<span class="sd">                Available operand `operand` are `[speed, acceleration, lead_distance, steering_angle, steering_rate, yaw_rate ]`.</span>
<span class="sd">                Details of operands are as follows:</span>

<span class="sd">                - speed: timeseries longitudinal speed of the vehicle</span>
<span class="sd">                - acceleration: timeseries longitudinal acceleration of the vehicle</span>
<span class="sd">                - lead_distance: timeseries distance of lead vehicle from the vehicle</span>
<span class="sd">                - steering_angle: timeseries steering angle of the vehicle</span>
<span class="sd">                - steering_rate: timeseries steering rate of the vehicle</span>
<span class="sd">                - yaw_rate: timeseries yaw rate of the vehicle</span>

<span class="sd">                For example, &quot;speed &lt; 2.3&quot;</span>
<span class="sd">            </span>
<span class="sd">            time: (t0, t1)</span>
<span class="sd">            </span>
<span class="sd">                `t0` start elapsed-time</span>
<span class="sd">                `t1` end elapsed-time</span>
<span class="sd">                </span>
<span class="sd">                Extracts messages from time `t0` to `t1`. `t0` and `t1` denotes elapsed-time and not the actual time.</span>
<span class="sd">                </span>
<span class="sd">            ids: `list`</span>

<span class="sd">                Get message dataframe containing messages given the list `id`</span>

<span class="sd">          </span>
<span class="sd">        Returns</span>
<span class="sd">        -----------</span>
<span class="sd">        `strymread`</span>
<span class="sd">            Returns strymread object with a modified dataframe attribute</span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Whole time by default</span>
        <span class="n">time</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">time</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time should be specified as a tuple with first value beginning time, and second value as end time. E.g . time=(10.0, 20.0)&#39;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># All message IDs by default</span>
        <span class="n">ids</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageIDs</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ids&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ids should be specified as an integer or a  list of integers.&#39;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">MessageID</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ids</span><span class="p">)]</span>

        <span class="n">conditions</span> <span class="o">=</span> <span class="kc">None</span>
        

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">conditions</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;conditions should be specified as a string or a  list of strings with valid conditions. See documentation for more detail..&#39;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">conditions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">r_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">r_new</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">df</span>
            <span class="k">return</span> <span class="n">r_new</span>

        <span class="n">subset_frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">conditions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">:</span>
                <span class="n">slices</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">con</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">con</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="c1"># removee whitespace characters - even multiple of them and replaces them with a single whitespace</span>
                
                <span class="c1"># get all the meassages for which lead vehicle is present.</span>
                <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;lead vehicle present&quot;</span><span class="p">:</span>
                    <span class="n">msg_DSU_CRUISE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;DSU_CRUISE&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
                    <span class="c1"># 252m is read in the front when radar doesn&#39;t see any vehicle in the front.</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">msg_DSU_CRUISE</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">252</span>

                <span class="k">elif</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cruise control on&quot;</span><span class="p">:</span>
                    <span class="n">acc_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acc_state</span><span class="p">()</span>
                    <span class="c1"># acc state of 6 denotes that cruise control was enabled.</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">acc_state</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">conlower</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="n">constrip</span> <span class="o">=</span> <span class="n">conlower</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">constrip</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsupported conditions provided. See documentation for more details.&quot;</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported conditions provided. See documentation for more details.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>

                    <span class="n">operators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="s1">&#39;==&#39;</span><span class="p">,</span><span class="s1">&#39;!=&#39;</span><span class="p">]</span>
                    <span class="n">operand</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;acceleration&#39;</span><span class="p">,</span> <span class="s1">&#39;lead_distance&#39;</span><span class="p">,</span> <span class="s1">&#39;steering_angle&#39;</span><span class="p">,</span> <span class="s1">&#39;steering_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;yaw_rate&#39;</span> <span class="p">]</span>

                    <span class="n">valuecheck</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">valuecheck</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">valuecheck</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="c1"># This is equivalent to pattern: `operator op value`</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">operand</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">operators</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">valuecheck</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;speed&#39;</span><span class="p">:</span>
                            <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>
                        
                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;acceleration&#39;</span><span class="p">:</span>
                            <span class="n">acceleration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accelx</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;steering_angle&#39;</span><span class="p">:</span>
                            <span class="n">steering_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_angle</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;steering_rate&#39;</span><span class="p">:</span>
                            <span class="n">steering_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_rate</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;steering_rate&#39;</span><span class="p">:</span>
                            <span class="n">steering_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_rate</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yaw_rate&#39;</span><span class="p">:</span>
                            <span class="n">yaw_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaw_rate</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="o">==</span> <span class="s1">&#39;message&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">operators</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">valuecheck</span><span class="p">):</span>
                        <span class="c1"># above condition check something like 386.LONG_DIST.Message &gt; 34.0 where 345 is a valid message id.</span>
                        <span class="n">required_id</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                        <span class="k">if</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                            <span class="n">required_signal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">required_signal</span> <span class="o">=</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

                        <span class="k">if</span> <span class="n">required_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageIDs</span><span class="p">():</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Request Message ID </span><span class="si">{}</span><span class="s1"> was unavailable in the data file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">required_id</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">))</span>
                            <span class="k">raise</span>

                        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">required_id</span><span class="p">,</span> <span class="n">required_signal</span><span class="p">)</span>

                        <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;ts &quot;</span> <span class="o">+</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                <span class="c1"># Get the list of time slices satisfying the given condition</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">slices</span> <span class="o">=</span> <span class="n">timeslices</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">time_frame</span> <span class="ow">in</span> <span class="n">slices</span><span class="p">:</span>
                    <span class="n">sliced_frame</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">time_frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">time_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                    <span class="n">subset_frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sliced_frame</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subset_frames</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">set_frames</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">subset_frames</span><span class="p">)</span>
            <span class="n">r_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">r_new</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">set_frames</span>
            <span class="k">return</span> <span class="n">r_new</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data was extracted based on the given condition(s).&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="strymread.time_subset"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.time_subset">[docs]</a>    <span class="k">def</span> <span class="nf">time_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Get the time slices satsifying a particular condition for the dataframe.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        </span>
<span class="sd">        kwargs: variable list of argument in the dictionary format</span>

<span class="sd">            conditions: `str` | `list&lt;str&gt;`</span>
<span class="sd">            </span>
<span class="sd">                Human readable condition for subsetting of message dataframe.</span>
<span class="sd">                Following conditions are available:</span>
<span class="sd">            </span>
<span class="sd">            - &quot;lead vehicle present&quot;: Extracts only those message for which there was lead vehicle present.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        --------</span>
<span class="sd">        `list`</span>
<span class="sd">            A list of tuples with start and end time of slices. E.g. [(t0, t1), (t2, t3), ...] satisfying the given conditions</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">conditions</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">conditions</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;conditions&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;conditions should be specified as a string or a  list of strings with valid conditions. See documentation for more detail..&#39;</span><span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">slices_set</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">conditions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">:</span>
                <span class="n">slices</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">con</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">con</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="c1"># removee whitespace characters - even multiple of them and replaces them with a single whitespace</span>
                <span class="c1"># get all the meassages for which lead vehicle is present.</span>
                <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;lead vehicle present&quot;</span><span class="p">:</span>
                    <span class="n">msg_DSU_CRUISE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="s1">&#39;DSU_CRUISE&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
                    <span class="c1"># 252m is read in the front when radar doesn&#39;t see any vehicle in the front.</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">msg_DSU_CRUISE</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">252</span>
            
                <span class="k">elif</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cruise control on&quot;</span><span class="p">:</span>
                    <span class="n">acc_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acc_state</span><span class="p">()</span>
                    <span class="c1"># acc state of 6 denotes that cruise control was enabled.</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">acc_state</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">conlower</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="n">constrip</span> <span class="o">=</span> <span class="n">conlower</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">constrip</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsupported conditions provided. See documentation for more details.&quot;</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported conditions provided. See documentation for more details.&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>

                    <span class="n">operators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="s1">&#39;==&#39;</span><span class="p">,</span><span class="s1">&#39;!=&#39;</span><span class="p">]</span>
                    <span class="n">operand</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;acceleration&#39;</span><span class="p">,</span> <span class="s1">&#39;lead_distance&#39;</span><span class="p">,</span> <span class="s1">&#39;steering_angle&#39;</span><span class="p">,</span> <span class="s1">&#39;steering_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;yaw_rate&#39;</span> <span class="p">]</span>

                    <span class="n">valuecheck</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">valuecheck</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="n">valuecheck</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="c1"># This is equivalent to pattern: `operator op value`</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">operand</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">operators</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">valuecheck</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;speed&#39;</span><span class="p">:</span>
                            <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>
                        
                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;acceleration&#39;</span><span class="p">:</span>
                            <span class="n">acceleration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accelx</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;steering_angle&#39;</span><span class="p">:</span>
                            <span class="n">steering_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_angle</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;steering_rate&#39;</span><span class="p">:</span>
                            <span class="n">steering_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_rate</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;steering_rate&#39;</span><span class="p">:</span>
                            <span class="n">steering_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_rate</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yaw_rate&#39;</span><span class="p">:</span>
                            <span class="n">yaw_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaw_rate</span><span class="p">()</span>
                            <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conlower</span><span class="p">)</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="o">==</span> <span class="s1">&#39;message&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">operators</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">valuecheck</span><span class="p">):</span>
                        <span class="c1"># above condition check something like 386.LONG_DIST.Message &gt; 34.0 where 345 is a valid message id.</span>
                        <span class="n">required_id</span> <span class="o">=</span>  <span class="nb">int</span><span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                        <span class="k">if</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                            <span class="n">required_signal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">required_signal</span> <span class="o">=</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

                        <span class="k">if</span> <span class="n">required_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">messageIDs</span><span class="p">():</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Request Message ID </span><span class="si">{}</span><span class="s1"> was unavailable in the data file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">required_id</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">))</span>
                            <span class="k">raise</span>

                        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">required_id</span><span class="p">,</span> <span class="n">required_signal</span><span class="p">)</span>

                        <span class="n">bool_result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;ts &quot;</span> <span class="o">+</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">constrip</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="n">bool_result</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>

                <span class="c1"># Get the list of time slices satisfying the given condition</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">slices</span> <span class="o">=</span> <span class="n">timeslices</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="n">slices_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">slices_set</span></div>

<div class="viewcode-block" id="strymread.extract"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.extract">[docs]</a>    <span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_rewrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Extract the known messages in HDF5 and MAT file for further downstream analysis</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>

<span class="sd">        force_rewrite: `bool`, default: False</span>
<span class="sd">            If the mat file exists then `force_rewrite=True` regenerates the file and overwrite the existing one.</span>
<span class="sd">            If the mat file doesn&#39;t exist, then this parameter will be ignored.</span>
<span class="sd"> </span>
<span class="sd">        Returns</span>
<span class="sd">        -----------</span>
<span class="sd">        `list`: </span>
<span class="sd">            A list of  strings that is file names of extracted data files</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">matfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csvfile</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.mat&quot;</span>

        <span class="n">checkfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">matfile</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">checkfile</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data file </span><span class="si">{}</span><span class="s2"> already exists&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matfile</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">force_rewrite</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Overwriting ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No overwriting. Pass &#39;force_rewrite=True&#39; to overwrite the extracted data file.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_dbc</span><span class="p">()</span>

        <span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>

        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">candb</span>

        <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No CAN Database found. Unable to extract data&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="n">speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">()</span>
        <span class="n">accely</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accely</span><span class="p">()</span>
        <span class="n">accelx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accelx</span><span class="p">()</span>
        <span class="n">accelz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accelz</span><span class="p">()</span>
        <span class="n">steer_torque</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_torque</span><span class="p">()</span>
        <span class="n">yaw_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaw_rate</span><span class="p">()</span>
        <span class="n">steer_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_rate</span><span class="p">()</span>
        <span class="n">steer_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_angle</span><span class="p">()</span>
        <span class="n">steer_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_fraction</span><span class="p">()</span>
        <span class="n">wheel_speed_fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wheel_speed_fl</span><span class="p">()</span>
        <span class="n">wheel_speed_fr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wheel_speed_fr</span><span class="p">()</span>
        <span class="n">wheel_speed_rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wheel_speed_rr</span><span class="p">()</span>
        <span class="n">wheel_speed_rl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wheel_speed_rl</span><span class="p">()</span>
        

        <span class="n">track_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
        <span class="n">long_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_dist</span><span class="p">(</span><span class="n">track_ids</span><span class="p">)</span>
        <span class="n">lat_dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_dist</span><span class="p">(</span><span class="n">track_ids</span><span class="p">)</span>
        <span class="n">rel_accel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rel_accel</span><span class="p">(</span><span class="n">track_ids</span><span class="p">)</span>
        <span class="n">acc_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acc_state</span><span class="p">()</span>

        <span class="n">dt_object</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
        <span class="n">creation_date</span> <span class="o">=</span> <span class="n">dt_object</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">-%H-%M-%S-</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="kn">import</span> <span class="nn">socket</span>
        <span class="n">system_name</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
        <span class="n">variable_dictionary</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">variable_dictionary</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="n">speed</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;accely&#39;</span><span class="p">:</span> <span class="n">accely</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;accelx&#39;</span><span class="p">:</span> <span class="n">accelx</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;accelz&#39;</span><span class="p">:</span> <span class="n">accelz</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> 
            <span class="s1">&#39;steer_torque&#39;</span><span class="p">:</span> <span class="n">steer_torque</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>  <span class="s1">&#39;yaw_rate&#39;</span><span class="p">:</span> <span class="n">yaw_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;steer_rate&#39;</span><span class="p">:</span> <span class="n">steer_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
            <span class="s1">&#39;steer_angle&#39;</span><span class="p">:</span> <span class="n">steer_angle</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;steer_fraction&#39;</span><span class="p">:</span> <span class="n">steer_fraction</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;wheel_speed_fl&#39;</span><span class="p">:</span> <span class="n">wheel_speed_fl</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
            <span class="s1">&#39;wheel_speed_fr&#39;</span><span class="p">:</span> <span class="n">wheel_speed_fr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;wheel_speed_rr&#39;</span><span class="p">:</span> <span class="n">wheel_speed_rr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
            <span class="s1">&#39;wheel_speed_rl&#39;</span><span class="p">:</span> <span class="n">wheel_speed_rl</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="s1">&#39;acc_state&#39;</span><span class="p">:</span> <span class="n">acc_state</span><span class="p">,</span> <span class="s1">&#39;creation_date&#39;</span><span class="p">:</span> <span class="n">creation_date</span><span class="p">,</span>
            <span class="s1">&#39;system_name&#39;</span><span class="p">:</span> <span class="n">system_name</span> <span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span>
            <span class="n">variable_dictionary</span><span class="p">[</span><span class="s1">&#39;long_dist_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">long_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">variable_dictionary</span><span class="p">[</span><span class="s1">&#39;lat_dist_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">lat_dist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">variable_dictionary</span><span class="p">[</span><span class="s1">&#39;rel_accel_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">rel_accel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">db</span><span class="o">.</span><span class="n">messages</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Extracting </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">signal_tree</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
                <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">message</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="n">signal</span><span class="p">)</span>
                <span class="n">variable_dictionary</span><span class="p">[</span><span class="n">message</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">signal</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="n">sio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="n">matfile</span><span class="p">,</span> <span class="n">variable_dictionary</span><span class="p">)</span>

        <span class="n">files_written</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matfile</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">files_written</span></div>

<div class="viewcode-block" id="strymread.create_chunks"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.create_chunks">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_chunks</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">continuous_threshold</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">column_of_interest</span> <span class="o">=</span> <span class="s1">&#39;Message&#39;</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `create_chunks` computes separate chunks from a timeseries data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        df: `pandas.DataFrame`</span>
<span class="sd">            DataFrame that needs to divided into chunks</span>

<span class="sd">        continuous_threshold: `float`, Default = 3.0</span>
<span class="sd">            Continuous threshold above which we a change point detection is made, and signals start of a new chunk.</span>

<span class="sd">        column_of_interest: `str` , Default = &quot;Message&quot;</span>
<span class="sd">            Column of interest in DataFrame on which `continuous_threshold` should act to detect change point for creation of chunks</span>

<span class="sd">        plot: `bool`, Default = False</span>
<span class="sd">            If True, a scatter plot of Full timeseries of `df` overlaid with separate continuous chunks of `df` will be created.</span>

<span class="sd">        Returns</span>
<span class="sd">        ---------</span>
<span class="sd">        `list` of `pandas.DataFrame</span>
<span class="sd">            Returns a list of DataFrame with same columns as `df`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column_of_interest</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Supplied column of interest not available in columns of supplied df.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            
        <span class="k">if</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is no Time column in supplied df. Please pass a df with a Time column.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            
        <span class="n">chunksdf_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">last</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">continue</span>

            <span class="c1"># Change point detection</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="n">column_of_interest</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last</span><span class="p">][</span><span class="n">column_of_interest</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">continuous_threshold</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">last</span><span class="p">]</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">chunksdf_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

            <span class="n">last</span> <span class="o">=</span> <span class="n">i</span>

            <span class="c1"># when the last message is read</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">last</span><span class="p">]</span>
                <span class="n">chunksdf_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_fig</span><span class="p">(</span><span class="n">num_of_subplots</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">column_of_interest</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span> <span class="mi">20</span><span class="p">,</span> \
                        <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#462255&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">chunksdf_list</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">column_of_interest</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">d</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">column_of_interest</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Full Timeseries overlaid with Separate Continuous Chunks&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            
        <span class="k">return</span> <span class="n">chunksdf_list</span></div>

    
<div class="viewcode-block" id="strymread.topic2msgs"><a class="viewcode-back" href="../../api_docs.html#strym.strymread.topic2msgs">[docs]</a>    <span class="k">def</span> <span class="nf">topic2msgs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">topic</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return a dictionary value with the message ID and signal name for this particular DBC file, based on</span>
<span class="sd">        the passed in topic name. This is needed because various DBC files have different default names and </span>
<span class="sd">        signal structures depending on manufacturer. This redirection provides robustness to strym when the </span>
<span class="sd">        dbc files are not standardized---as they will never be so.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        topic: `string`</span>
<span class="sd">            The string name of the topic in question. Only limited topics are supported by default</span>

<span class="sd">        Returns</span>
<span class="sd">        -------------</span>
<span class="sd">        d: `dictionary`</span>
<span class="sd">            Dictionary with the key/value pairs for `message` and `signal` that should be </span>
<span class="sd">            passed to the corresponding strym function. To access the message signal, use</span>
<span class="sd">            d[&#39;message&#39;] and d[&#39;signal&#39;]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="n">dbcshort</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbcfile</span><span class="p">)</span>
<span class="c1">#         print(&#39;dbcshort={},topic={},dict={}&#39;.format(dbcshort,topic,self.dbcdict))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbcdict</span><span class="p">[</span><span class="n">dbcshort</span><span class="p">][</span><span class="n">topic</span><span class="p">]</span>
        <span class="c1"># TODO add an exception here if the d return value is empty</span>
        <span class="k">return</span> <span class="n">d</span></div>

    <span class="k">def</span> <span class="nf">_dbc_addTopic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dbcfile</span><span class="p">,</span><span class="n">topic</span><span class="p">,</span><span class="n">message</span><span class="p">,</span><span class="n">signal</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a new message/signal pair to a topic of interest for this DBC file. For example,</span>
<span class="sd">        the Toyota Rav4 speed is found in a CAN Message with message name SPEED and signal 1, </span>
<span class="sd">        but for a Honda Pilot the speed is in a message named ENGINE_DATA with signal &#39;XMISSION_SPEED&#39;</span>
<span class="sd">        </span>
<span class="sd">        The use of this method allows the init function to consistently create dictionary entries</span>
<span class="sd">        that can be queried at runtime to get the correct message/signal pair for the DBC file in use,</span>
<span class="sd">        by functions that will be extracting the correct data.</span>
<span class="sd">        </span>
<span class="sd">        This function should typically be called only by _dbc_init_dict during initialization</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        dbcfile: `string`</span>
<span class="sd">            The stringname of the dbc file, without any path, but including the file extension</span>
<span class="sd">            </span>
<span class="sd">        topic: `string`</span>
<span class="sd">            The abstracted name of the signal of interest, e.g., &#39;speed&#39;</span>
<span class="sd">        </span>
<span class="sd">        message: `string`</span>
<span class="sd">            The CAN Message Name from within the DBC file that corresponds to the topic</span>
<span class="sd">        </span>
<span class="sd">        signal: `string`</span>
<span class="sd">            The signal within the CAN message that provides the data of interest</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dbcdict</span><span class="p">[</span><span class="n">dbcfile</span><span class="p">][</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">message</span><span class="p">,</span> <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="n">signal</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">_dbc_init_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialize the dictionary for all potential DBC files we are using. The name </span>
<span class="sd">        of the dbcfile (without the path) is used as the key, and the values are</span>
<span class="sd">        additional dictionaries that give the message/signal pair for signals of interest</span>
<span class="sd">        </span>
<span class="sd">        To add to this dictionary, take exising message/signal known pairs, and add them</span>
<span class="sd">        to the DBC file for which they are valid. The dictionary created by this init</span>
<span class="sd">        function is used by other functions to get the correct pairs for query.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        -------------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">toyota</span><span class="o">=</span><span class="s1">&#39;newToyotacode.dbc&#39;</span>
        <span class="n">honda</span><span class="o">=</span><span class="s1">&#39;honda_pilot_touring_2017_can_generated.dbc&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbcdict</span><span class="o">=</span><span class="p">{</span> <span class="n">toyota</span><span class="p">:</span> <span class="p">{</span> <span class="p">},</span>
                       <span class="n">honda</span> <span class="p">:</span> <span class="p">{</span> <span class="p">}</span>
                     <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dbc_addTopic</span><span class="p">(</span><span class="n">toyota</span><span class="p">,</span><span class="s1">&#39;speed&#39;</span><span class="p">,</span><span class="s1">&#39;SPEED&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dbc_addTopic</span><span class="p">(</span><span class="n">toyota</span><span class="p">,</span><span class="s1">&#39;steer_angle&#39;</span><span class="p">,</span><span class="s1">&#39;STEER_ANGLE_SENSOR&#39;</span><span class="p">,</span><span class="s1">&#39;STEER_ANGLE&#39;</span><span class="p">)</span>
<span class="c1"># NEXT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dbc_addTopic</span><span class="p">(</span><span class="n">honda</span><span class="p">,</span><span class="s1">&#39;speed&#39;</span><span class="p">,</span><span class="s1">&#39;ENGINE_DATA&#39;</span><span class="p">,</span><span class="s1">&#39;XMISSION_SPEED&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dbc_addTopic</span><span class="p">(</span><span class="n">honda</span><span class="p">,</span><span class="s1">&#39;steer_angle&#39;</span><span class="p">,</span><span class="s1">&#39;STEERING_SENSORS&#39;</span><span class="p">,</span><span class="s1">&#39;STEER_ANGLE&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="integrate"><a class="viewcode-back" href="../../api_docs.html#strym.integrate">[docs]</a><span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">init</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">integrator</span><span class="o">=</span><span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">):</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Integrate a timeseries data using scipy.integrate.cumtrapz</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    df: `pandas.Datframe`</span>
<span class="sd">        A two column Pandas data frame. First Column should have name &#39;Time&#39; and Second Column Should be named &#39;Message&#39;</span>

<span class="sd">    init: `double`</span>
<span class="sd">        Initial conditions for integration. Default Value: 0.0.</span>

<span class="sd">    integrator: `function`</span>
<span class="sd">        Integrator method. By default, it is `scipy.integrate.cumptrapz`</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    df: `pandas.Datframe`</span>
<span class="sd">        A two column Pandas data frame with first column named &#39;Time&#39; and second column named &#39;Message&#39;</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data frame provided is not a timeseries data.</span><span class="se">\n</span><span class="s2">For standard timeseries data, Column 1 should be &#39;Time&#39; and Column 2 should be &#39;Message&#39; &quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    
    <span class="k">if</span> <span class="s1">&#39;Message&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column naming convention violated.</span><span class="se">\n</span><span class="s2">For standard timeseries data, Column 1 should be &#39;Time&#39; and Column 2 should be &#39;Message&#39; &quot;</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">integrator</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">init</span><span class="p">)</span>

    <span class="n">newdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
    <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">newdf</span></div>

<div class="viewcode-block" id="differentiate"><a class="viewcode-back" href="../../api_docs.html#strym.differentiate">[docs]</a><span class="k">def</span> <span class="nf">differentiate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Differentiate the given timeseries datafrom using spline derivative</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    df:  `pandas.DataFrame`</span>
<span class="sd">        Original Dataframe to be differentiated</span>

<span class="sd">    Returns</span>
<span class="sd">    ------------</span>
<span class="sd">    `pandas.DataFrame`</span>
<span class="sd">        Differentiated Timeseries Data</span>

<span class="sd">    method: `str`</span>
<span class="sd">        Specifies method used for differentiation</span>

<span class="sd">        S: spline, spline based differentiation</span>
<span class="sd">        </span>
<span class="sd">        AE: autoencoder based denoising-followed by discrete differentiation</span>

<span class="sd">    kwargs</span>
<span class="sd">        variable keyword arguments</span>
<span class="sd">    </span>
<span class="sd">    verbose: `bool`</span>
<span class="sd">        If True, print logs</span>

<span class="sd">    dense_time_points: `bool`</span>
<span class="sd">        Used in AutoEncoder `AE` based differentiation. If True, then differnetiation is computer on 50 times denser time points.</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">dense_time_points</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dense_time_points&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1"># find the time values that are same and drop the latter entry. It is essential for spline</span>
    <span class="c1"># interpolation to work </span>
    <span class="n">collect_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">collect_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">collect_indices</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;Timestamps are not unique&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">UnivariateSpline</span>
        <span class="n">spl</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
        
        <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
        <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span> 

    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;AE&quot;</span><span class="p">:</span>
        <span class="n">time_original</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    
        <span class="k">if</span> <span class="n">time_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_original</span> <span class="o">-</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">time_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">time_original</span>
        <span class="n">message_original</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>    
        
        <span class="k">if</span> <span class="n">message_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="n">message_original</span>  <span class="o">-</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">message_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">message_original</span>
        
        <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
        <span class="c1"># Training</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">time</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        
        
        <span class="n">newtimepoints_scaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="n">y_predicted_scaled</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">newtimepoints_scaled</span><span class="p">)</span>

        <span class="n">newtimepoints</span> <span class="o">=</span> <span class="n">newtimepoints_scaled</span><span class="o">*</span><span class="p">(</span><span class="n">time_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_predicted</span> <span class="o">=</span> <span class="n">y_predicted_scaled</span><span class="o">*</span><span class="p">(</span><span class="n">message_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">dense_time_points</span><span class="p">:</span>
            <span class="n">newtimepoints_scaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newtimepoints_scaled</span> <span class="o">=</span> <span class="n">time</span>
        <span class="n">y_predicted_scaled</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">newtimepoints_scaled</span><span class="p">)</span>

        <span class="n">newtimepoints</span> <span class="o">=</span> <span class="n">newtimepoints_scaled</span><span class="o">*</span><span class="p">(</span><span class="n">time_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">time_original</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_predicted</span> <span class="o">=</span> <span class="n">y_predicted_scaled</span><span class="o">*</span><span class="p">(</span><span class="n">message_original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">message_original</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newtimepoints</span>
        <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_predicted</span>
        
        <span class="n">collect_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">collect_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_new</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">df_new</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">collect_indices</span><span class="p">)</span>
        
        <span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;Timestamps are not unique&#39;</span><span class="p">)</span>
        
        <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">/</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
        <span class="n">df_new</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">df_new</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df_new</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;diff&quot;</span><span class="p">:</span> <span class="s2">&quot;Message&quot;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_new</span></div>

<div class="viewcode-block" id="denoise"><a class="viewcode-back" href="../../api_docs.html#strym.denoise">[docs]</a><span class="k">def</span> <span class="nf">denoise</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;MA&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Denoise the time-series dataframe `df` using `method`. By default moving-average is used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    --------------</span>
<span class="sd">    df:  `pandas.DataFrame`</span>
<span class="sd">        Original Dataframe to denoise</span>

<span class="sd">    method: `string`, &quot;MA&quot;</span>
<span class="sd">        Specifies method used for denoising</span>

<span class="sd">        MA: moving average (default)   </span>

<span class="sd">    kwargs</span>
<span class="sd">        variable keyword arguments</span>

<span class="sd">            window_size: `int`</span>
<span class="sd">                window size used in moving-average based denoising method</span>

<span class="sd">                Default value: 10</span>

<span class="sd">    Returns</span>
<span class="sd">    ------------</span>
<span class="sd">    `pandas.DataFrame`</span>
<span class="sd">        Denoised Timeseries Data</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">window_size</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">window_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;window_size&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>
    
    
    <span class="n">df_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">df_temp</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
    <span class="n">df_temp</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;MA&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">window_size</span> <span class="o">&gt;=</span>  <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Specified window size for moving-average method is larger than the length of time-series data&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">df_temp</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="n">window_size</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">index</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">df_temp</span></div>

<div class="viewcode-block" id="resample"><a class="viewcode-back" href="../../api_docs.html#strym.resample">[docs]</a><span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Resample the time-series dataframe `df` of varying, non-uniform sampling.</span>

<span class="sd">    Resampling is done using cubic interpolation and spline method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    df: `pandas.DataFrame`</span>
<span class="sd">        Original Dataframe to be resampled</span>

<span class="sd">    rate: `double`</span>
<span class="sd">        Desired sampling rate</span>

<span class="sd">    Returns</span>
<span class="sd">    ------------</span>
<span class="sd">    dfnew1: `pandas.DataFrame`</span>
<span class="sd">        New resampled timseries DataFrame</span>

<span class="sd">    &#39;&#39;&#39;</span>
     <span class="c1"># divide time-axis equal as per given rate</span>
    <span class="n">dft0</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dftend</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">dftend</span> <span class="o">-</span> <span class="n">dft0</span><span class="p">)</span><span class="o">*</span><span class="n">rate</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">t_newdf1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dft0</span><span class="p">,</span> <span class="n">dftend</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># Interpolate function using cubic method</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
    <span class="n">newvalue1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">t_newdf1</span><span class="p">)</span>

    <span class="n">dfnew1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_newdf1</span>
    <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newvalue1</span>    
    <span class="k">return</span> <span class="n">dfnew1</span></div>

<div class="viewcode-block" id="ts_sync"><a class="viewcode-back" href="../../api_docs.html#strym.ts_sync">[docs]</a><span class="k">def</span> <span class="nf">ts_sync</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Time-synchronize and resample two time-series dataframes of varying, non-uniform sampling.</span>
<span class="sd">    </span>
<span class="sd">    In a non-ideal condition, the first time of `df1` timeseries dataframe will not be same as</span>
<span class="sd">    the first time of `df2` dataframe.</span>
<span class="sd">    </span>
<span class="sd">    In that case, we will calculate the value of message at the latest of two first times of `df1`</span>
<span class="sd">    and `df2` using linear interpolation method. Call the latest of two first time as `latest_first_time`.</span>
<span class="sd">    </span>
<span class="sd">    Similarly, we will calculate the value of message at the earliest of two end times of `df1`</span>
<span class="sd">    and `df2` using linear interpolation method. Call the latest of two first time as `earliest_last_time`.</span>
<span class="sd">    </span>
<span class="sd">    Linear interpolation formula is </span>

<span class="sd">    .. math::</span>
<span class="sd">        X_i = \cfrac{X_A - X_B}{a-b}(i-b) + X_B</span>


<span class="sd">    Next, we will truncate anything beyond [`latest_first_time`, `earliest_last_time`]</span>
<span class="sd">    </span>
<span class="sd">    Once we have common first and last time in both timeseries dataframes, we will use cubic interpolation </span>
<span class="sd">    to do uniform sampling and interpolation of both time-series dataframe.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    df1: `pandas.DataFrame`</span>
<span class="sd">        First timeseries datframe. First column name must be named &#39;Time&#39; and second column must be &#39;Message&#39;</span>
<span class="sd">    </span>
<span class="sd">    df2: `pandas.DataFrame`</span>
<span class="sd">        Second timeseries datframe. First column name must be named &#39;Time&#39; and second column must be &#39;Message&#39;</span>
<span class="sd">        </span>
<span class="sd">    rate: `double` | `str`</span>
<span class="sd">        `double`: New uniform sampling rate</span>

<span class="sd">        `str`: Inherting sampling rate from. If rate=&quot;first&quot;, then df2 will be sampled by inheriting time points from df1. </span>
<span class="sd">        If rate=&quot;second&quot; , then df1 will be sampled by inheriting time points from df2</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    dfnew1: `pandas.DataFrame`</span>
<span class="sd">        First new resampled timseries DataFrame</span>
<span class="sd">    </span>
<span class="sd">    dfnew2: `pandas.DataFrame`</span>
<span class="sd">        Second new resampled timseries DataFrame</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1"># It means first time of df1 is earlier than df2 in time-series data</span>
        <span class="c1"># so we have to interpolate speed value at df2&#39;s first time.</span>
        <span class="c1"># we will use linear interpolation</span>
        <span class="c1"># find a next time on df1&#39;s axis that is greater than df2&#39;s first time</span>
        <span class="n">tempdf</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">timenext</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">valuenext</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">interpol</span> <span class="o">=</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">valuenext</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">timenext</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">timenext</span><span class="p">)</span> <span class="o">+</span> <span class="n">valuenext</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Time&#39;</span> <span class="p">:</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;Message&#39;</span> <span class="p">:</span> <span class="n">interpol</span><span class="p">}</span> <span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1"># It means first time of df2 is earlier than df1 in time-truncated data</span>
        <span class="c1"># so we have to interpolate message value at df1&#39;s first time.</span>
        <span class="c1"># we will use linear interpolation</span>
        <span class="c1"># find a next time on df2&#39;s axis that is greater thandf1&#39;s first time</span>
        <span class="n">tempdf</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">timenext</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">valuenext</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">interpol</span> <span class="o">=</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">valuenext</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">timenext</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">timenext</span><span class="p">)</span> <span class="o">+</span> <span class="n">valuenext</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Time&#39;</span> <span class="p">:</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;Message&#39;</span> <span class="p">:</span> <span class="n">interpol</span><span class="p">}</span> <span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">df1</span><span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
    <span class="n">df2</span><span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
    
        <span class="c1">## Truncate.</span>
    <span class="k">if</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">elif</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 
    
    
    <span class="k">assert</span> <span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">df2</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="s2">&quot;First time of two timeseries dataframe is nor equal. First time of df1: </span><span class="si">{0}</span><span class="s2">, First time of df2: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df2</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    
    
    <span class="k">if</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="c1"># It means last time of df1 is earlier than df2 in time-series data</span>
        <span class="c1"># so we have to interpolate df2 value at df1&#39;s last time.</span>
        <span class="c1"># we will use linear interpolation</span>
        <span class="c1"># find a time before on df2&#39;s axis that is less than df1&#39;s last time</span>
        <span class="n">tempdf</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">timefirst</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">valuefirst</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">interpol</span> <span class="o">=</span> <span class="p">(</span><span class="n">valuefirst</span> <span class="o">-</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">timefirst</span> <span class="o">-</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">timefirst</span> <span class="o">-</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Time&#39;</span> <span class="p">:</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;Message&#39;</span> <span class="p">:</span> <span class="n">interpol</span><span class="p">}</span> <span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="c1"># It means last time of df2 is earlier than df1 in time-series data</span>
        <span class="c1"># so we have to interpolate df1 value at df2&#39;s last time.</span>
        <span class="c1"># we will use linear interpolation</span>
        <span class="c1"># find a next time on df1&#39;s axis that is less than df2&#39;s last time</span>
        <span class="n">tempdf</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">timefirst</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">valuefirst</span> <span class="o">=</span> <span class="n">tempdf</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">interpol</span> <span class="o">=</span> <span class="p">(</span><span class="n">valuefirst</span><span class="o">-</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">timefirst</span> <span class="o">-</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">timefirst</span> <span class="o">-</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Time&#39;</span> <span class="p">:</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;Message&#39;</span> <span class="p">:</span> <span class="n">interpol</span><span class="p">}</span> <span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="n">df1</span><span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
    <span class="n">df2</span><span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
    <span class="c1"># truncate</span>
    <span class="k">if</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">elif</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>


    <span class="k">assert</span> <span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">df2</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s2">&quot;The last time of two timeseries dataframe is not equal. Last time of df1: </span><span class="si">{0}</span><span class="s2">, Last time of df2: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">df2</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># If rate is a string, then time points of one dataframe will be inherited from the other dataframe</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="s2">&quot;second&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid value for rate.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="c1"># if rate == &quot;first&quot;, then second dataframe will inherit time points from first dataframe for interpolation</span>
        
        <span class="n">dfnew1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">dfnew2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">==</span> <span class="s2">&quot;first&quot;</span><span class="p">:</span>
            
            <span class="n">is_sorted</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

            <span class="k">if</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                <span class="c1"># At this some values on time axis are same (because we have sorted it the time above):</span>
                <span class="c1"># find the time values that are same and drop the latter entry. It is essential for cubic</span>
                <span class="c1"># interpolation to work </span>
                <span class="n">collect_indices</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">collect_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">collect_indices</span><span class="p">])</span>

            <span class="k">assert</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)),</span> <span class="s2">&quot;Time array is not sorrted for dataframe 2&quot;</span>
            
            <span class="c1"># Interpolate function using cubic method</span>
            <span class="n">f2</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
            <span class="n">newvalue2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            
            <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

            <span class="n">dfnew2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dfnew2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newvalue2</span>


        <span class="k">elif</span> <span class="n">rate</span><span class="o">==</span><span class="s2">&quot;second&quot;</span><span class="p">:</span>

            <span class="n">is_sorted</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

            <span class="k">if</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
                <span class="c1"># At this some values on time axis are same (because we have sorted it the time above):</span>
                <span class="c1"># find the time values that are same and drop the latter entry. It is essential for cubic</span>
                <span class="c1"># interpolation to work </span>
                <span class="n">collect_indices</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">collect_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">collect_indices</span><span class="p">])</span>
            
            <span class="k">assert</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)),</span> <span class="s2">&quot;Time array is not sorrted for dataframe 1&quot;</span>


            <span class="n">f1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
            <span class="n">newvalue1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newvalue1</span>

            <span class="n">dfnew2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">dfnew2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="k">return</span> <span class="n">dfnew1</span><span class="p">,</span> <span class="n">dfnew2</span>
        
    <span class="c1"># Control will go here only if rate is not &quot;first&quot; or &quot;second&quot;</span>
    
    <span class="c1"># divide time-axis equal as per given rate</span>
    <span class="n">df1t0</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df1tend</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">df1tend</span> <span class="o">-</span> <span class="n">df1t0</span><span class="p">)</span><span class="o">*</span><span class="n">rate</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">t_newdf1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df1t0</span><span class="p">,</span> <span class="n">df1tend</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># divide time-axis equal as per given rate</span>
    <span class="n">df2t0</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df2tend</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">df2tend</span> <span class="o">-</span> <span class="n">df2t0</span><span class="p">)</span><span class="o">*</span><span class="n">rate</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">t_newdf2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df2t0</span><span class="p">,</span> <span class="n">df2tend</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="p">(</span><span class="n">t_newdf1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">t_newdf2</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="s2">&quot;Total numbers of samples are not same in resamples timeseries.&quot;</span>
            
    <span class="n">is_sorted</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="k">if</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># At this some values on time axis are same (because we have sorted it the time above):</span>
        <span class="c1"># find the time values that are same and drop the latter entry. It is essential for cubic</span>
        <span class="c1"># interpolation to work </span>
        <span class="n">collect_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">collect_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">collect_indices</span><span class="p">])</span>
    
    <span class="k">assert</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)),</span> <span class="s2">&quot;Time array is not sorrted for dataframe 1&quot;</span>
    
    <span class="c1"># Interpolate function using cubic method</span>
    
    <span class="n">f1</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
    <span class="n">newvalue1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">t_newdf1</span><span class="p">)</span>

    <span class="k">if</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># At this some values on time axis are same (because we have sorted it the time above):</span>
        <span class="c1"># find the time values that are same and drop the latter entry. It is essential for cubic</span>
        <span class="c1"># interpolation to work </span>
        <span class="n">collect_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">collect_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">collect_indices</span><span class="p">])</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">is_sorted</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)),</span> <span class="s2">&quot;Time array is not sorrted for dataframe 2&quot;</span>
    
    <span class="c1"># Interpolate function using cubic method</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">],</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
    <span class="n">newvalue2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">t_newdf2</span><span class="p">)</span>
    
    <span class="n">dfnew1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_newdf1</span>
    <span class="n">dfnew1</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newvalue1</span>
    
    <span class="n">dfnew2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">dfnew2</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_newdf2</span>
    <span class="n">dfnew2</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newvalue2</span>
    
    <span class="k">return</span> <span class="n">dfnew1</span><span class="p">,</span> <span class="n">dfnew2</span></div>

<div class="viewcode-block" id="split_ts"><a class="viewcode-back" href="../../api_docs.html#strym.split_ts">[docs]</a><span class="k">def</span> <span class="nf">split_ts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="mf">30.0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Split the timeseries data by `by` seconds</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">    df: `pandas.DataFrame`</span>
<span class="sd">        dataframe to split</span>
<span class="sd">        </span>
<span class="sd">    by: `double`</span>
<span class="sd">        Specify the interval in seconds by which the timseries dataframe needs to split</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    `pandas.DataFrame`</span>
<span class="sd">        `dataframe` with an extra column *Second* denoting splits specified by interval</span>
<span class="sd">        </span>
<span class="sd">    `pandas.DataFrame` Array</span>
<span class="sd">        An array of splitted pandas Dataframe by Seconds</span>


<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
    <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Message&#39;</span><span class="p">]</span>
    <span class="n">initial_time</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">second_elapsed</span> <span class="o">=</span> <span class="n">by</span>
    <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Second&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span>  <span class="n">dataframe</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">next_time</span> <span class="o">=</span> <span class="n">initial_time</span> <span class="o">+</span> <span class="n">by</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">initial_time</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">next_time</span><span class="p">)):</span>
            <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="s1">&#39;Second&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">second_elapsed</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">next_time</span><span class="p">):</span>
            <span class="n">initial_time</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
            <span class="n">second_elapsed</span> <span class="o">=</span> <span class="n">second_elapsed</span> <span class="o">+</span> <span class="n">by</span>
            <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="s1">&#39;Second&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">second_elapsed</span>
    
    <span class="n">df_split</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">second</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Second&#39;</span><span class="p">):</span>
        <span class="n">df_split</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dataframe</span><span class="p">,</span> <span class="n">df_split</span></div>

<div class="viewcode-block" id="centroid"><a class="viewcode-back" href="../../api_docs.html#strym.centroid">[docs]</a><span class="k">def</span> <span class="nf">centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the centroid of a phase-space cluster specified by `X` and `Y` Vectors</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X: `pandas.core.series.Series`</span>
<span class="sd">        X-coordinate on phase-space </span>
<span class="sd">    Y: `pandas.core.series.Series`</span>
<span class="sd">        Y-coordinate on phase-space</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    --------</span>
<span class="sd">    `float, float`</span>
<span class="sd">        Centroid of the phase space cluster specified by `X` and `Y` Vectors</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">C_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">C_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">C_x</span><span class="p">,</span> <span class="n">C_y</span></div>

<div class="viewcode-block" id="AWCSS"><a class="viewcode-back" href="../../api_docs.html#strym.AWCSS">[docs]</a><span class="k">def</span> <span class="nf">AWCSS</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculates the average distance of phase-space cluster specified by `X` and `Y` Vectors from its centroid</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X: `pandas.core.series.Series`</span>
<span class="sd">        X-coordinate on phase-space </span>
<span class="sd">    Y: `pandas.core.series.Series`</span>
<span class="sd">        Y-coordinate on phase-space</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    --------</span>
<span class="sd">    `float`</span>
<span class="sd">        Average within the cluster distance from centroid</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)),</span> <span class="p">(</span><span class="s2">&quot;length of X-vector and Y-vector are not same&quot;</span><span class="p">)</span>
    <span class="n">C_x</span><span class="p">,</span> <span class="n">C_y</span> <span class="o">=</span> <span class="n">centroid</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="ow">or</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">]):</span>
            <span class="k">continue</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">((</span><span class="n">C_x</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">])</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">C_y</span> <span class="o">-</span> <span class="n">Y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">])</span><span class="o">**</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">dist</span>
    <span class="n">avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">avg</span></div>

<div class="viewcode-block" id="ranalyze"><a class="viewcode-back" href="../../api_docs.html#strym.ranalyze">[docs]</a><span class="k">def</span> <span class="nf">ranalyze</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A utility  function to analyse rate of a timeseries data</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    title: `str`</span>
<span class="sd">        A descriptive string for this particular analysis</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data frame provided is not a timeseries data.</span><span class="se">\n</span><span class="s2">For standard timeseries data, Column 1 should be &#39;Time&#39; and Column 2 should be &#39;Message&#39; &quot;</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Analyzing Timestamp and Data Rate of &#39;</span> <span class="o">+</span> <span class="n">title</span><span class="p">)</span>
    <span class="c1"># Calculate instaneous rate</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">diffs</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">diffs</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="s1">&#39;Time Diff&#39;</span><span class="p">})</span>
    <span class="n">inst_rate</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
    <span class="n">inst_rate</span> <span class="o">=</span> <span class="n">inst_rate</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Time Diff&#39;</span><span class="p">:</span> <span class="s1">&#39;Inst Rate&#39;</span><span class="p">})</span>
    <span class="n">df_toconcate</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">,</span> <span class="n">diffs</span><span class="p">,</span> <span class="n">inst_rate</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_toconcate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="n">inst_rate</span> <span class="o">=</span> <span class="n">inst_rate</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># drop the first row</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">diffs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># drop the first row</span>
    <span class="c1"># Calculate few parameters</span>
    <span class="n">mean_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">median_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
    <span class="n">max_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
    <span class="n">min_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
    <span class="n">std_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
    <span class="n">first_quartile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">third_quartile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">inst_rate</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="mi">75</span><span class="p">)</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">third_quartile</span><span class="o">-</span> <span class="n">first_quartile</span> <span class="c1">#interquartile range</span>


    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interquartile Range of Rate for </span><span class="si">{}</span><span class="s1"> is </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">iqr</span><span class="p">))</span>
    <span class="c1"># plot the histogram of rate</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_fig</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># fig, axes = plt.subplots(ncols=2, nrows=2)</span>
    <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">inst_rate</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Rate Histogram&#39;</span><span class="p">)</span>

    <span class="n">inst_rate</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;Rate Box Plot&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;Mean: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mean_rate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, Median:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">median_rate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, Max:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">max_rate</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, Min:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">min_rate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, STD:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std_rate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, IQR:&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">iqr</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    
    <span class="c1"># plot the time diffs as a function of time.</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">diffs</span><span class="p">[</span><span class="s1">&#39;Time Diff&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Timeseries of Time diffs&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Time Diffs&#39;</span><span class="p">)</span>

    <span class="c1"># plot frequency as a function of time</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="s1">&#39;Inst Rate&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Timeseries of Instantaneous Frequency&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Message Rate Analysis: &quot;</span><span class="o">+</span> <span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plt_ts"><a class="viewcode-back" href="../../api_docs.html#strym.plt_ts">[docs]</a><span class="k">def</span> <span class="nf">plt_ts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A utility function to plot a timeseries</span>
<span class="sd">    &#39;&#39;&#39;</span> 
    <span class="k">if</span> <span class="s1">&#39;Time&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data frame provided is not a timeseries data.</span><span class="se">\n</span><span class="s2">For standard timeseries data, Column 1 should be &#39;Time&#39; and Column 2 should be &#39;Message&#39; &quot;</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_fig</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Message&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Timeseries plot: &quot;</span><span class="o">+</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="violinplot"><a class="viewcode-back" href="../../api_docs.html#strym.violinplot">[docs]</a><span class="k">def</span> <span class="nf">violinplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Violin Plot&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A violin plot to show the data distribution</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">_setplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="n">sea</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span><span class="n">df</span> <span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Violin Plot: &quot;</span> <span class="o">+</span> <span class="n">title</span><span class="p">)</span>

    <span class="n">sea</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Box Plot: &quot;</span> <span class="o">+</span> <span class="n">title</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="temporalviolinplot"><a class="viewcode-back" href="../../api_docs.html#strym.temporalviolinplot">[docs]</a><span class="k">def</span> <span class="nf">temporalviolinplot</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A temporal plot showing evolution of distribution as a function by time</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">speed_split</span><span class="p">,</span> <span class="n">split</span> <span class="o">=</span> <span class="n">split_ts</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">by</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sea</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">create_fig</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sea</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Second&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">speed_split</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Temporal Violin Plot: &quot;</span> <span class="o">+</span> <span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="timeindex"><a class="viewcode-back" href="../../api_docs.html#strym.timeindex">[docs]</a><span class="k">def</span> <span class="nf">timeindex</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert multi Dataframe of which on column must be &#39;Time&#39;  to pandas-compatible timeseries where timestamp is used to replace indices</span>

<span class="sd">    Parameters</span>
<span class="sd">    --------------</span>

<span class="sd">    df: `pandas.DataFrame`</span>
<span class="sd">        A pandas dataframe with two columns with the column names &quot;Time&quot; and &quot;Message&quot;</span>

<span class="sd">    inplace: `bool`</span>
<span class="sd">        Modifies the actual dataframe, if true, otherwise doesn&#39;t.</span>

<span class="sd">    Returns</span>
<span class="sd">    -----------</span>
<span class="sd">    `pandas.DataFrame`</span>
<span class="sd">        Pandas compatible timeseries with a single column having column name &quot;Message&quot; where indices are timestamp in hum  an readable format.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">newdf</span> <span class="o">=</span> <span class="n">df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">newdf</span> <span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
    <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;ClockTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">dateparse</span><span class="p">)</span>
    <span class="n">Time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">newdf</span><span class="p">[</span><span class="s1">&#39;Clock&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">Time</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">newdf</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Clock&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="n">newdf</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ClockTime&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">newdf</span> <span class="o">=</span> <span class="n">newdf</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Clock&#39;</span><span class="p">)</span>
        <span class="n">newdf</span> <span class="o">=</span> <span class="n">newdf</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ClockTime&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newdf</span></div>

<div class="viewcode-block" id="dateparse"><a class="viewcode-back" href="../../api_docs.html#strym.dateparse">[docs]</a><span class="k">def</span> <span class="nf">dateparse</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Converts POSIX timestamp to human readable Datformat as per local timezone</span>

<span class="sd">    Parameters</span>
<span class="sd">    -------------</span>
<span class="sd">    ts: `float`</span>
<span class="sd">        POSIX formatted timestamp </span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    `str`</span>
<span class="sd">        Human-readable timestamp as per local timezone</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
    <span class="c1"># if you encounter a &quot;year is out of range&quot; error the timestamp</span>
    <span class="c1"># may be in milliseconds, try `ts /= 1000` in that case</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S:</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="timeslices"><a class="viewcode-back" href="../../api_docs.html#strym.timeslices">[docs]</a><span class="k">def</span> <span class="nf">timeslices</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `timeslices` return a set of timeslices in the form of `[(t0, t1), (t2, t3), ...]`</span>
<span class="sd">    from `ts` where ts is a square pulse (or a timeseries) representing two levels 0 and 1</span>
<span class="sd">    or True and False where True for when a certain condition was satisfied and False for</span>
<span class="sd">    when condition was not satisfied. For example: ts should be a pandas Series (index with timestamp)</span>
<span class="sd">    with values  `[True, True, True, ...., False, False, ..., True, True, True ]` which represents </span>
<span class="sd">    square pulses. In that case, `t0, t2, ...` are times for edge rising, and `t1, t2, ...` for edge falling.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    --------</span>
<span class="sd">    ts: `pandas.core.series.Series`</span>
<span class="sd">        A valid pandas time series with timestamp as index for the series</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    --------</span>
<span class="sd">    `list`</span>
<span class="sd">        A list of tuples with start and end time of slices. E.g. `[(t0, t1), (t2, t3), ...]`</span>
<span class="sd">     &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">ts</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        
    <span class="n">tsdiff</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

    <span class="c1"># diff creates a NaN in the first row, so that can affect the calculation.</span>
    <span class="c1"># In that case, we NaN can be replaced with 1 if there was True</span>
    <span class="n">tsdiff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">slices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">time_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span>  <span class="kc">None</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tsdiff</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Rising Edge Detected. We will get index to rising edge</span>
            <span class="n">location_of_index</span> <span class="o">=</span> <span class="n">tsdiff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">indexer_at_time</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">time_tuple</span> <span class="o">==</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">required_index</span> <span class="o">=</span> <span class="n">tsdiff</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">location_of_index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="c1"># time_tuple = (required_index[0], None)</span>
                <span class="n">time_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                
        <span class="k">elif</span> <span class="n">row</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Falling Edge Detected. We will get index before falling edge</span>
            <span class="n">location_of_index</span> <span class="o">=</span> <span class="n">tsdiff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">indexer_at_time</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">time_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">time_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">required_index</span> <span class="o">=</span> <span class="n">tsdiff</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">location_of_index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">time_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">required_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                <span class="c1">#time_tuple = (time_tuple[0], index)</span>
                <span class="n">slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_tuple</span><span class="p">)</span>
                <span class="n">time_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span>  <span class="kc">None</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">slices</span></div>

<span class="k">def</span> <span class="nf">_setplots</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">IPython</span> 
    
    <span class="n">shell_type</span> <span class="o">=</span> <span class="n">IPython</span><span class="o">.</span><span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nrows</span><span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">):</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ncols&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">):</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;nrows&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">shell_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">,</span> <span class="s1">&#39;TerminalInteractiveShell&#39;</span><span class="p">]:</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">8</span><span class="o">*</span><span class="n">nrows</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">16.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#ffffff&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span> <span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Roboto&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#828282&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.minor.visible&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.visible&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#828282&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#cfcfcf&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titleweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.titlesize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">24.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.titleweight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.markerscale&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">2.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">nrows</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">12.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#ffffff&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span> <span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Roboto&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#828282&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.minor.visible&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.minor.visible&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#828282&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#000000&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#cfcfcf&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titleweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.titlesize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">24.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.titleweight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.markerscale&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;legend.framealpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        

<span class="k">def</span> <span class="nf">create_fig</span><span class="p">(</span><span class="n">num_of_subplots</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="kn">import</span> <span class="nn">IPython</span> 
    <span class="n">shell_type</span> <span class="o">=</span> <span class="n">IPython</span><span class="o">.</span><span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>


    <span class="n">nrows</span> <span class="o">=</span> <span class="n">num_of_subplots</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">):</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ncols&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">):</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;nrows&#39;</span><span class="p">]</span>
    
    <span class="n">_setplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">)</span>
    

    <span class="k">if</span> <span class="n">nrows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ax_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">hexversion</span> <span class="o">&gt;=</span> <span class="mh">0x3000000</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.25&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dimgray&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="s1">&#39;0.25&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dimgray&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;#efefef&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#828282&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#828282&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#828282&#39;</span><span class="p">)</span>
            <span class="n">a</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;#828282&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
            <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>

    </div>
      
  </div>
</div>
  <!--h5>Page customatization by Rahul Bhadani.</h5-->
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Rahul Bhadani.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.<br/>
    </p>
  </div>
</footer>

  </body>
</html>